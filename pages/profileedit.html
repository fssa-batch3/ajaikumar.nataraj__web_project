<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../assets/CSS/profile.css" />
  </head>
  <body>
    <header>
      <button id="delete">Delete</button>
      <button id="logout" click="logout" type="button">
        <span class="glyphicon glyphicon-log-out"></span> Log out
      </button>
    </header>
    <form class="main" id="form">
      <div class="profile">
        <img src="../assets/image/profile.png" alt="apple" /> <br />
        <label for="Home_Address">Home Address</label>
        <input id="Home_Address" class="input" placeholder="Home Address" />
        <label for="Land_Address">Land Address</label>
        <input id="Land_Address" class="input" placeholder="Land Address" />
        <label for="gender">Gender</label>
        <input
          id="gender"
          list="genders"
          name="type"
          class="input"
          autocomplete="off"
          placeholder="Gender (Male / Female)"
        />
        <datalist id="genders">
          <option value="Male"></option>
          <option value="Female"></option>
          <option value="Others"></option>
        </datalist>
        <label for="land">Land Type</label>
        <input
          id="farmer"
          name="type"
          class="input"
          list="land"
          autocomplete="off"
          placeholder="Farming land (Own / Tenant)"
        />
        <datalist id="land">
          <option value="Own"></option>
          <option value="Tenant"></option>
        </datalist>
      </div>
      <div class="form" id="form">
        <label for="User name">User name</label> <br />
        <input id="First_name" class="input" placeholder="User Name" />
        <label for="ph no">Phone Number</label>
        <input id="Phone_Number" class="input" placeholder="Phone Number" />
        <label for="email">Email</label>
        <input id="Email" class="input" placeholder="Email" disabled />
        <label for="password">Password</label>
        <input id="password" class="input" placeholder="Password" />
        <label for="Date of Birth">Date of Birth</label>
        <input id="DOB" type="date" class="input" placeholder="Date of Birth" />
        <label for="aadhar number">Aadhar Number</label>
        <input id="Aadhar_number" class="input" placeholder="Aadhar Number" />
        <label for="state">State</label>
        <input
          type="text"
          id="state"
          list="State"
          placeholder="Select your state"
        />
        <datalist id="State" name="State">
          <option value="" selected disabled>Select State</option>
          <option value="Andhra Pradesh">Andhra Pradesh</option>
          <option value="Arunachal Pradesh">Arunachal Pradesh</option>
          <option value="Assam">Assam</option>
          <option value="Bihar">Bihar</option>
          <option value="Chhattisgarh">Chhattisgarh</option>
          <option value="Goa">Goa</option>
          <option value="Gujarat">Gujarat</option>
          <option value="Haryana">Haryana</option>
          <option value="Himachal Pradesh">Himachal Pradesh</option>
          <option value="Jharkhand">Jharkhand</option>
          <option value="Karnataka">Karnataka</option>
          <option value="Kerala">Kerala</option>
          <option value="Madhya Pradesh">Madhya Pradesh</option>
          <option value="Maharashtra">Maharashtra</option>
          <option value="Manipur">Manipur</option>
          <option value="Meghalaya">Meghalaya</option>
          <option value="Mizoram">Mizoram</option>
          <option value="Nagaland">Nagaland</option>
          <option value="Odisha">Odisha</option>
          <option value="Punjab">Punjab</option>
          <option value="Rajasthan">Rajasthan</option>
          <option value="Sikkim">Sikkim</option>
          <option value="Tamil Nadu">Tamil Nadu</option>
          <option value="Telangana">Telangana</option>
          <option value="Tripura">Tripura</option>
          <option value="Uttar Pradesh">Uttar Pradesh</option>
          <option value="Uttarakhand">Uttarakhand</option>
          <option value="West Bengal">West Bengal</option>
        </datalist>
        <label for="country">Country</label>
        <input
          id="country"
          name="type"
          class="input"
          list="countries"
          autocomplete="off"
          value="India"
        />
        <datalist id="countries">
          <option value="India"></option>
        </datalist>
        <button type="submit">SUBMIT</button>
      </div>
    </form>
    <footer></footer>

    <script>
      const inputDate = document.getElementById("DOB");
      const today = new Date();
      today.setFullYear(today.getFullYear() - 18);
      const minDate = today.toISOString().split("T")[0];
      inputDate.setAttribute("max", minDate);

      const oneUser = JSON.parse(localStorage.getItem("logIn"));

      const user_info = JSON.parse(localStorage.getItem("user_info"));
      let select_user = user_info.find(function (event) {
        let customerEmail = event["Email"];
        if (user_info == customerEmail) {
          return true;
        } else if (oneUser == customerEmail) {
          return true;
        }
      });

      console.log(select_user);
      // to get value from registration form
      const email = document.getElementById("Email");
      const phNo = document.getElementById("Phone_Number");
      const userName = document.getElementById("First_name");
      const password = document.getElementById("password");
      const DOB = document.getElementById("DOB");
      const transport_DOB = document.getElementById("DOB");
      const Home_Address = document.getElementById("Home_Address");
      const Land_Address = document.getElementById("Land_Address");
      const gender = document.getElementById("gender");
      const farmer = document.getElementById("farmer");
      const Aadhar_number = document.getElementById("Aadhar_number");
      const state = document.getElementById("state");
      const country = document.getElementById("country");

      // Compare the values

      email.value = select_user["Email"];
      phNo.value = select_user["Phone_number"];
      userName.value = select_user["FullName"];
      password.value = select_user["Password"];
      DOB.value = select_user["DOB"];
      transport_DOB.value = select_user["DOB"];
      Home_Address.value = select_user["Home_Address"] || "";
      Land_Address.value = select_user["Land_Address"] || "";
      gender.value = select_user["gender"] || "";
      farmer.value = select_user["farmer"] || "";
      Aadhar_number.value = select_user["Aadhar_number"] || "";
      state.value = select_user["state"] || "";
      country.value = select_user["country"] || "";

      // to replace the values
      const form = document.getElementById("form");
      form.addEventListener("submit", function (event) {
        event.preventDefault();

        let FullName = document.getElementById("First_name").value;
        // let Email = document.getElementById("Email").value;
        let Phone_number = document.getElementById("Phone_Number").value;
        let Password = document.getElementById("password").value;
        let DOB = document.getElementById("DOB").value;
        let transport_DOB = document.getElementById("DOB").value;
        let Home_Address = document.getElementById("Home_Address").value;
        let Land_Address = document.getElementById("Land_Address").value;
        let gender = document.getElementById("gender").value;
        let farmer = document.getElementById("farmer").value;
        let Aadhar_number = document.getElementById("Aadhar_number").value;
        let state = document.getElementById("state").value;
        let country = document.getElementById("country").value;

        let newData = {
          FullName,
          // Email,
          Phone_number,
          Password,
          DOB,
          transport_DOB,
          Home_Address,
          Land_Address,
          gender,
          farmer,
          Aadhar_number,
          state,
          country,
        };
        console.log(newData);

        // assign the value to

        const combineData = Object.assign(select_user, newData);
        console.log(combineData);
        alert("successfully changed");

        let findIndex = user_info.indexOf(select_user);
        user_info[findIndex] = combineData;
        localStorage.setItem("user_info", JSON.stringify(user_info));
        // window.location.href = "/pages/profile.html";
        window.history.back();
      });

      // delete option in the page

      let delete_user = document.getElementById("delete");
      delete_user.addEventListener("click", function (event) {
        event.preventDefault();
        let indexDel = user_info.indexOf(select_user);
        let msg = confirm("Are you sure you want to delete this account");
        if (msg !== true) {
          return;
        } else {
          user_info.splice(indexDel, 1);
          console.log(user_info);
          localStorage.setItem("user_info", JSON.stringify(user_info));
          window.location.href = "/pages/1.signin.html";
        }
      });

      let logout_user = document.getElementById("logout");
      logout_user.addEventListener("click", function (event) {
        event.preventDefault();
        let indexDel = user_info.indexOf(select_user);
        let msg = confirm("Are you sure you want to logout this account");
        if (msg !== true) {
          return;
        } else {
          window.location.href = "/pages/2.Login.html";
        }
      });
    </script>
  </body>
</html>
